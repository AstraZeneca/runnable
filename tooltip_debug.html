<!DOCTYPE html>
<html>
<head>
    <title>Tooltip Debug</title>
    <style>
        body { font-family: system-ui, sans-serif; padding: 2rem; background: #f0f0f0; }
        .test-bar {
            width: 300px;
            height: 40px;
            background: linear-gradient(90deg, #22c55e, #16a34a);
            border-radius: 4px;
            margin: 1rem 0;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
        }
        .tooltip {
            position: absolute;
            background: #1e293b;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s ease;
            max-width: 400px;
            z-index: 1000;
            border: 2px solid #60a5fa;
        }
        .tooltip.show { opacity: 1; }
        .metadata-label { font-weight: 600; color: #a78bfa; }
        .metadata-section { margin: 0.5rem 0; }
    </style>
</head>
<body>
    <h1>Tooltip Debug Test</h1>
    <p>Hover over the bars to see tooltips with parameters:</p>

    <div class="test-bar"
         data-step="set_parameter"
         data-duration="9.8"
         data-status="SUCCESS"
         data-command="examples.common.functions.write_parameter"
         data-command-type="python"
         data-input-params=""
         data-output-params="integer=1 | floater=3.14 | stringer=&quot;hello&quot; | pydantic_param={'x': 10, 'foo': 'bar'} | score=0.9"
         data-catalog-put=""
         data-catalog-get="">
        HOVER: set_parameter (with output params)
    </div>

    <div class="test-bar"
         data-step="get_parameters"
         data-duration="22.0"
         data-status="SUCCESS"
         data-command="examples.common.functions.read_parameter"
         data-command-type="python"
         data-input-params="integer=1 | floater=3.14 | stringer=&quot;hello&quot; | pydantic_param={'x': 10, 'foo': 'bar'} | score=0.9"
         data-output-params=""
         data-catalog-put=""
         data-catalog-get="">
        HOVER: get_parameters (with input params)
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        const tooltip = document.getElementById('tooltip');

        document.querySelectorAll('.test-bar').forEach(bar => {
            bar.addEventListener('mouseenter', (e) => {
                console.log('Mouse enter:', e.target.dataset);

                const stepName = e.target.dataset.step;
                const duration = e.target.dataset.duration;
                const status = e.target.dataset.status;
                const command = e.target.dataset.command || '';
                const commandType = e.target.dataset.commandType || '';
                const inputParams = e.target.dataset.inputParams || '';
                const outputParams = e.target.dataset.outputParams || '';
                const catalogPut = e.target.dataset.catalogPut || '';
                const catalogGet = e.target.dataset.catalogGet || '';

                console.log('Parameters:', { inputParams, outputParams });

                let content = `<div class="metadata-section">
                    <div class="metadata-label">Step:</div> ${stepName}<br>
                    <div class="metadata-label">Duration:</div> ${duration}ms<br>
                    <div class="metadata-label">Status:</div> ${status}
                </div>`;

                if (command && commandType) {
                    content += `<div class="metadata-section">
                        <div class="metadata-label">Command:</div> ${commandType.toUpperCase()}<br>
                        <code>${command.length > 60 ? command.substring(0, 57) + '...' : command}</code>
                    </div>`;
                }

                if (inputParams) {
                    content += `<div class="metadata-section">
                        <div class="metadata-label">Input Parameters:</div> ${inputParams}
                    </div>`;
                }

                if (outputParams) {
                    content += `<div class="metadata-section">
                        <div class="metadata-label">Output Parameters:</div> ${outputParams}
                    </div>`;
                }

                if (catalogPut || catalogGet) {
                    content += `<div class="metadata-section">
                        <div class="metadata-label">Catalog Operations:</div><br>`;
                    if (catalogPut) content += `ðŸ“¤ PUT: ${catalogPut}<br>`;
                    if (catalogGet) content += `ðŸ“¥ GET: ${catalogGet}`;
                    content += `</div>`;
                }

                tooltip.innerHTML = content;
                tooltip.classList.add('show');
                console.log('Tooltip content:', content);
            });

            bar.addEventListener('mousemove', (e) => {
                tooltip.style.left = e.pageX + 10 + 'px';
                tooltip.style.top = e.pageY - 10 + 'px';
            });

            bar.addEventListener('mouseleave', () => {
                tooltip.classList.remove('show');
                console.log('Mouse leave');
            });
        });
    </script>
</body>
</html>